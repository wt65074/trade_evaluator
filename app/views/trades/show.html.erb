<div class="self-center items-center flex flex-col space-y-8 my-16">
  <div class="flex items-center flex-col max-w-1/2">
    <h1 class="font-bold font-mono text-4xl mb-2">Create Trade</h1>
    <h2 class="font-medium font-mono text-s text-slate-800 text-center">
      Choose a team to see their 2024 picks.<br/>
      When loading a trade, saving it will create a new one not modify the
      old.
    </h2>
  </div>
  <div
    data-controller="table"
    data-table-picks-by-team-value="<%= @picks_by_team.map {|v| [v.team, v.picks]}.to_h.to_json %>"
    data-table-picks-outlet="[class~=picks]"
    data-table-results-outlet="#results"
  >
    <%= form_with model: @trade, data: {action: "change->table#updatePicks", 'table-target':"form"}  do |form| %>
      <div class="flex flex-row items-start space-x-8">
        <div class="space-y-4">
          <%= form.label :team_a, "Team A", class: "font-mono text-s" %>
          <%= form.text_field :team_a,
                          list: "team-a",
                          class: "font-mono text-xs border-2 border-black",
                          data: {
                            action: "change->table#teamAChanged",
                            "table-target": "teamA",
                          } %>
          <datalist id="team-a">
            <% @picks_by_team.map { |team| team.team }.each do |team| %>
              <option value="<%= team %>"></option>
            <% end %>
          </datalist>
          <table
            id="picks-team-a"
            class="picks border-black shadow-md mx-16 font-mono"
            data-controller="picks"
          >
            <tr>
              <th class="border px-1 py-4 bg-black text-white font-mono text-xs">Ovr</th>
              <th class="border px-1 py-4 bg-black text-white font-mono text-xs">R</th>
              <th class="border px-1 py-4 bg-black text-white font-mono text-xs">Trade</th>
            </tr>
            <% @all_picks.each do |pick| %>
              <tr class="hover:bg-slate-100" data-pick="<%= pick%>" data-picks-target="row">
                <td class="border px-1 "><%= pick %></td>
                <td class="border px-1 "><%= pick / 32 + 1 %></td>
                <td class="border px-1"><%= form.check_box :team_a_picks,
                                 {
                                   data: {
                                     "picks-target": "checkbox",
                                   },
                                   multiple: true,
                                   class:
                                     "w-4 h-4  bg-gray-100 border-gray-300 rounded
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              focus:ring-blue-500 dark:focus:ring-blue-600
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              dark:border-gray-600",
                                 },
                                 pick,
                                 false %></td>
              </tr>
            <% end %>
          </table>
        </div>
        <div class="space-y-4">
          <%= form.label :team_b, "Team B", class: "font-mono text-s" %>
          <%= form.text_field :team_b,
                          list: "team-b",
                          class: "font-mono text-xs border-2 border-black",
                          data: {
                            action: "change->table#teamBChanged",
                            "table-target": "teamB",
                          } %>
          <datalist id="team-b">
            <% @picks_by_team.map { |team| team.team }.each do |team| %>
              <option value="<%= team %>"></option>
            <% end %>
          </datalist>
          <table
            id="picks-team-b"
            class="picks border-black shadow-md mx-16 font-mono"
            data-controller="picks"
          >
            <tr>
              <th class="border px-1 py-4 bg-black text-white font-mono text-xs">Ovr</th>
              <th class="border px-1 py-4 bg-black text-white font-mono text-xs">R</th>
              <th class="border px-1 py-4 bg-black text-white font-mono text-xs">Trade</th>
            </tr>
            <% @all_picks.each do |pick| %>
              <tr class="hover:bg-slate-100" data-pick="<%= pick%>" data-picks-target="row">
                <td class="border px-1 "><%= pick %></td>
                <td class="border px-1 "><%= pick / 32 + 1 %></td>
                <td class="border px-1"><%= form.check_box :team_b_picks,
                                 {
                                   data: {
                                     "picks-target": "checkbox",
                                   },
                                   multiple: true,
                                   class:
                                     "w-4 h-4  bg-gray-100 border-gray-300 rounded
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              focus:ring-blue-500 dark:focus:ring-blue-600
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              dark:border-gray-600",
                                 },
                                 pick,
                                 false %></td>
              </tr>
            <% end %>
          </table>
        </div>
        <div
          id="results"
          class="flex flex-row items-start"
          data-controller="results"
          data-results-models-value="<%= @models.map { |m| { "id" => m.id, "values" => m.to_map} }.to_json%>"
        >
          <div class="flex flex-col items-center space-y-2">
            <h2 class="text-xl font-mono">
              Results
            </h2>
            <h3 class="font-mono text-xs text-slate-700">
              Showing net score ie Opposing Team Value - Team Value.
            </h3>
            <table class="border-black shadow-md mx-16 font-mono text-xs">
              <tr>
                <th class="border px-1 py-4 bg-black text-white ">Team A</th>
                <% @models.each do |model| %>
                  <th class="border px-1 py-4 bg-black text-white font-mono text-xs"><%= model.name %></th>
                <% end %>
              </tr>
              <tr>
                <td data-results-target="teamAPicks">temp</td>
                <% @models.each do |model| %>
                  <td
                    id="<%= "score-A-#{model.id}" %>"
                    class="border px-1 py-4 font-mono text-xs"
                    data-results-target="teamAScore"
                    data-model-id="<%= "#{model.id}"%>"
                  >Test</td>
                <% end %>
              </tr>
              <tr>
                <th class="border px-1 py-4 bg-black text-white font-mono text-xs">Team B</th>
                <% @models.each do |model| %>
                  <th class="border px-1 py-4 bg-black text-white font-mono text-xs"><%= model.name %></th>
                <% end %>
              </tr>
              <tr>
                <td data-results-target="teamBPicks">temp</td>
                <% @models.each do |model| %>
                  <td
                    class="border px-1 py-4 font-mono text-xs"
                    data-results-target="teamBScore"
                    data-model-id="<%= "#{model.id}" %>"
                  >Test</td>
                <% end %>
              </tr>
            </table>
            <div data-controller="hello" class="flex flex-col items-center space-y-2 pt-2">
              <%= form.submit "Save Trade",
                          data: {
                            action: "click->hello#greet",
                          },
                          class:
                            "
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  bg-black border-r-4 text-white px-6 py-2 font-mono hover:shadow-md
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  hover:text-yellow-100 " %>
              <div data-controller="dissapearing">
                <% flash.each do |flash_type, message| %>
                  <div data-dissapearing-target="main" class="font-mono text-xs text-green-500">
                    &#10003;
                    <%= message %>
                  </div>
                <% end %>
              </div>
            </div>
          </div>
        </div>
      </div>
    <% end %>

  </div>
</div>
